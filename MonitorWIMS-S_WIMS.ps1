# Create a filter named 'timestamp' according to this article http://windowsitpro.com/windows/easily-add-timestamp-powershell-outputfilter timestamp {"$(Get-Date -Format G): $_"}# Query the service.  Store output to a variable for evaluation.$a = Get-Service -Name WIMS-S-SQL | Where-Object {$_.status -eq "running"}# Evaluate query with a simple if...elseif ($a)    {        # If the query returns anything, due to the "running" filter, that means the service is running.  Exit.        Write-Output "The service is running." | timestamp    }else    {        # If the query returns nothing, due to the "running" filter, that means the service is not running.  It could be paused!        Write-Output "The service is not running.  Starting service.  Please wait a moment for output..." | timestamp                # Get-Service | Set-Service is Powershell's way of starting a Windows service.        Get-Service -Name WIMS-S-SQL | Set-Service -Status Running                # Pause for 8 seconds, let the service start and settle.        sleep 8                # Query the service again, show the user whether or not the service started.        Get-Service -Name WIMS-S-SQL | Where-Object {$_.status -eq "running"}    }